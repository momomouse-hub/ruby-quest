# トランプゲーム『戦争』

![Ruby](https://img.shields.io/badge/Ruby-3.4.2-red.svg)


オブジェクト指向設計を使って実装した、トランプゲーム「戦争（War）」です。
プレイヤー同士がカードを出し合い、強いカードを出したプレイヤーが場のカードを獲得していくルールを再現しています。

---

## ゲームルール

戦争は、プレイヤーがカードを出し合って、カードの数の大小を比べ、強いカードを出したプレイヤーが勝ちとなり、場のカードを獲得していくゲームです。  
このようにして続けていき、誰かの手札がなくなったらゲーム終了となります。最後に最も多くカードを持っていたプレイヤーが勝者となります。

---

#### 詳細ルール

- 52枚のカードを使います（ジョーカーは使用しません）。
- プレイヤーの人数は2〜5人です。
- ゲーム開始時、親になったプレイヤーがカードをよくシャッフルし、各プレイヤーに裏向きで均等に配ります。これが「手札」です。手札は裏向きのままにしておきます。
- 「戦争！」の掛け声とともに、各プレイヤーは手札の一番上のカードを場にオモテ向きで置きます。
- 出されたカード同士の強さを比較し、一番強いカードを出したプレイヤーが勝者となり、場に出されたすべてのカード（場札）を獲得します。
- カードの強さは、A > K > Q > J > 10 > 9 > 8 > 7 > 6 > 5 > 4 > 3 > 2 の順です。
- 獲得したカードは手元に置いておき、手札がなくなった際によく切って新たな手札として加えます。
- 一番強いカードが複数枚出た場合、再度手札からカードを出して勝負を行います。勝敗が決まるまで繰り返します。
- 誰かの手札がなくなったらゲーム終了となり、その時点で手札に多くのカードを持っていたプレイヤーから順に順位が決定します。

#### Advancedルール（追加ルール）

- ゲームにジョーカー1枚を追加します。
  - ジョーカーはすべてのカードよりも強く、出された場合は無条件で勝利となります。
- Aのカードに特別ルールを設定します。
  - 出された最強カードがAの場合、**スペードのA**を出したプレイヤーのみ「世界一」となり、無条件で勝利します。
  - 複数人がAを出していても、スペードのAを出したプレイヤーが優先されます。

##### カード強さ（Advanced版）

ジョーカー > スペードのA > 他のA > K > Q > J > 10 > ... > 2

---

## ファイル構成・役割

### libディレクトリ

| ファイル名 | 役割 |
|:--|:--|
| `card.rb` | カード1枚を表現するクラス。スートと数字を持ち、カード同士の強さ比較ができる。 |
| `player.rb` | プレイヤー1人を表現するクラス。手札を管理し、カードを出す・受け取るアクションを担当。 |
| `game.rb` | ゲーム全体の進行管理クラス。ゲーム準備、ターン進行、勝敗判定を担当。 |
| `game_controller.rb` | 入力受付・メッセージ表示など、ゲーム進行の司令塔。 |
| `main.rb` | エントリーポイント。ゲームを起動する。 |

### testディレクトリ

| ファイル名 | 役割 |
|:--|:--|
| `card_test.rb` | `Card`クラスの単体テスト（Step2までの仕様に基づく）。 |
| `player_test.rb` | `Player`クラスの単体テスト（Step2までの仕様に基づく）。 |
| `game_test.rb` | `Game`クラスの単体テスト（Step2までの仕様に基づく）。 |
| `game_controller_test.rb` | `GameController`クラスの単体テスト（Step2までの仕様に基づく）。 |

※ テストコードはStep2（手札がなくなったら順位決定まで）に対応しています。

---

## 使用しているGem

| Gem名 | 説明 |
|:--|:--|
| `bundler` | 必要なGemのインストール・管理。 |
| `minitest` | 単体テストフレームワーク。 |
| `rubocop` | Rubyコードのスタイルチェックツール。 |

- `.rubocop.yml`、`.rubocop_todo.yml` を使い、コードスタイル管理も行っています。

---

## 開発ステップ

| ステップ | 内容 |
|:--|:--|
| Step 1 | プレイヤー2人用の簡単な「戦争」ゲームを作成。カードの比較・勝敗判定・コンソール出力を実装。 |
| Step 2 | 手札がなくなったらゲーム終了、順位決定機能を追加。 |
| Step 3 | プレイヤー人数を2〜5人で選択できる機能と、プレイヤー名登録機能を追加。 |
| Step 4 | 最強カードのジョーカー追加、スペードのAが出たら「スペードのAは世界一！」と宣言し、無条件勝利できるルールを導入。 |

---

## 遊び方

1. `main.rb`を実行します。

    ```bash
    ruby lib/main.rb
    ```

2. コンソールに従って人数と名前を入力します。
3. 「戦争！」の掛け声とともにカードを出していきます。
4. 誰かの手札がなくなるとゲーム終了、順位が発表されます。

---

## 実行イメージ

```text
戦争を開始します。
プレイヤーの人数を入力してください（2〜5）: 2
プレイヤー1の名前を入力してください: たろう
プレイヤー2の名前を入力してください: じろう
カードが配られました。
戦争！
たろうのカードはハートの7です。
じろうのカードはクラブの7です。
引き分けです。
戦争！
たろうのカードはダイヤのQです。
じろうのカードはスペードの7です。
たろうが勝ちました。たろうはカードを2枚もらいました。
...(省略)
じろうの手札がなくなりました。
たろうの手札の枚数は52枚です。
じろうの手札の枚数は0枚です。
たろうが1位、じろうが2位です。
戦争を終了します。
```

---

## テスト実行

テストはMinitestで実行できます。

```bash
ruby test/card_test.rb
ruby test/player_test.rb
ruby test/game_test.rb
ruby test/game_controller_test.rb
```
